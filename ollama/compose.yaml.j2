version: "3.9"
services:
  ollama:
    container_name: ollama
    image: ollama/ollama:latest
    env_file: [.env.ollama]
    ports:
      - "11434:11434"
    volumes: [/srv/docker/ollama/data:/root/.ollama]
    restart: unless-stopped
    healthcheck:
      test: ["CMD","curl","-sf","http://localhost:11434/api/tags"]
      interval: 15s
      timeout: 3s
      retries: 10
    deploy:
      resources:
        reservations:
          devices: [{ driver: nvidia, count: all, capabilities: [gpu] }]

