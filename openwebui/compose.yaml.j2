version: "3.9"
networks:
  frontend:
    external: true

services:
  open-webui:
    container_name: open-webui
    image: ghcr.io/open-webui/open-webui:main
    env_file:
      - .env.openwebui
    volumes:
      - /srv/docker/open-webui/data:/app/backend/data
    extra_hosts:
      - "ollama.{{ domain }}:{{ ai_compute_ip }}"
      - "qdrant.{{ domain }}:{{ ai_compute_ip }}"
    networks: [frontend]
    restart: unless-stopped
    labels:
      traefik.enable: "true"
      traefik.http.routers.webui.rule: Host(`chat.{{ domain }}`)
      traefik.http.routers.webui.entrypoints: websecure
      traefik.http.routers.webui.tls: "true"
      traefik.http.services.webui.loadbalancer.server.port: "8080"
      # No ForwardAuth middleware - Open WebUI uses OIDC for SSO
